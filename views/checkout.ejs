<%- include("partials/newHeader.ejs") %>

<style>
	.default-btn {
		font-weight: light;
		font-size: medium;
		background-color: #ffaa3d;
		border-radius: 50px;
		padding: 7px 14px 7px 14px;
		color: white;
	}
</style>

<div data-content-region="header_bottom"></div>
<div class="body" data-currency-code="EUR">

	<div class="home-content">
		<div class="tt-breadcrumbs-main">
			<div class="tt-breadcrumbs">
				<div class="container">
					<h1 class="category-name">
						<span class="breadcrumb-title ">
						</span>
						<span class="breadcrumb-title ">
						</span>
						<span class="breadcrumb-title is-active">
							<span class="breadcrumb-label">Checkout</span>
						</span>
					</h1>
					<ul class="breadcrumbs" itemscope itemtype="http://schema.org/BreadcrumbList">
						<li class="breadcrumb " itemprop="itemListElement" itemscope
							itemtype="http://schema.org/ListItem">
							<a href="/" class="breadcrumb-label" itemprop="item"><span itemprop="name">Home</span></a>
							<meta itemprop="position" content="1" />
						</li>
						<li class="breadcrumb " itemprop="itemListElement" itemscope
							itemtype="http://schema.org/ListItem">
							<a href="/items" class="breadcrumb-label" itemprop="item"><span
									itemprop="name">Cart</span></a>
							<meta itemprop="position" content="2" />
						</li>
						<li class="breadcrumb is-active" itemprop="itemListElement" itemscope
							itemtype="http://schema.org/ListItem">
							<meta itemprop="item" content="/laundry-detergent/">
							<span class="breadcrumb-label" itemprop="name">Checkout</span>
							<meta itemprop="position" content="3" />
						</li>
					</ul>
				</div>
			</div>
		</div>

		<div style="margin-left: 15%; margin-right: 15%;">
			<div class="uk-child-width-1-2@m" uk-grid>
				<div style="text-align: left !important;">
					<div class="uk-overflow-auto">
						<table class="uk-table uk-table-hover uk-table-middle uk-table-divider">
							<thead>
								<tr>
									<th class="uk-table-shrink">Image</th>
									<th class="uk-table-expand">Name</th>
									<th class="uk-width-small">Quantity</th>
									<th class="uk-table-small">Total</th>
								</tr>
							</thead>
							<tbody>
								<% var sum = 0 %>
								<% cart.forEach(cartItem => { %>
								<tr>
									<td><img class="uk-preserve-width uk-border-circle"
											src="<%=cartItem.item.image[0]%>" width="40" alt=""></td>
									<td class="uk-table-link">
										<a class="uk-link-reset" href=""><%=cartItem.item.name%></a>
									</td>
									<td class="uk-table-link">
										<a class="uk-link-reset" href=""><%=cartItem.quantity%></a>
									</td>
									<td class="uk-text-nowrap">₹
										<%=parseInt(cartItem.quantity) * parseInt(cartItem.price[0])%></td>
									<% sum = sum + parseInt(cartItem.quantity) * parseInt(cartItem.price[0]) %>
								</tr>
								<% }) %>
								<tr>
									<td></td>
									<td></td>
									<td><b>Cart Subtotal</b></td>
									<td>₹ <%=sum%></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div>
					<div class="uk-card uk-card-default" style="text-align: left !important;">
						<div class="uk-card-body">
							<form method="POST" action="/checkout">
								<div class="uk-margin">
									<div class="uk-form-label">
										<h6>Select your Address:</h6>
									</div>
									<div class="uk-form-controls uk-form-controls-text">

										<% address.address.forEach(el => { %>
										<input class="uk-radio" type="radio" name="address" value="<%=el._id%>" required>
										<label>
											<span
												style="color: #fa7725; text-transform: uppercase; font-size: medium;"><%=el.addressType%></span>
											<br>
											<%=(el.fullAddress + ", " + el.landmark  + ", " + el.locality + ", " + 
											el.city + ", " + el.state +".")%><br>
											PIN: <%=(el.pincode) %><br>
											Phone Number: <span
												style="color: #fa7725; text-transform: uppercase;"><%=el.phone%></span></label><br>
										<% }) %>

									</div>
								</div>

								<% if (currentUser.isBusiness && currentUser.creditAllowed) { %>
								<div class="uk-form-label">
									<h6>Credit Percentage:</h6>
								</div>
								<div class="uk-child-width-expand@s uk-text-center" uk-grid>
									<p>
										<input type="radio" id="5P" value=5 name="perc">
										<label for="5P" value=5>5%</label>
									</p>
									<p>
										<input type="radio" id="10P" value=10 name="perc">
										<label for="10P" value=10>10%</label>
									</p>
									<p>
										<input type="radio" id="20P" value=20 name="perc">
										<label for="20P" value=20>20%</label>
									</p>
								</div>
								<% } %>

								<div class="uk-margin">
									<input class="uk-input uk-form-width-medium" type="text" placeholder="Offer Code">
								</div>

								<div class="uk-grid-column-small uk-grid-row-small uk-child-width-1-4@s uk-text-center"
									uk-grid>
									<div>
										<button class="default-btn" type="submit">Place Order</button>
									</div>
									<% if (codAllowed) { %>
									<div>
										<button class="default-btn" type="submit" formaction="/order-cod">Order as
											COD</button>
									</div>
									<% } %>
									<% if (currentUser.isBusiness && currentUser.creditAllowed) { %>
									<div>
										<button class="default-btn" type="submit" formaction="/order-credit">Place Order
											as Credit</button>
									</div>
									<% } %>
									<div>
										<button class="default-btn" type="submit" formaction="/save-order">Save
											Order</button>
									</div>
									<div>
										<button class="default-btn" type="submit" formaction="">Create Quote</button>
									</div>
									<!-- Prakhar writes formaction-->
								</div>


							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<%- include("partials/newFooter.ejs") %>